# ============================================================================
# SmilePile Staging Environment Configuration
# ============================================================================
# Pre-production environment that mirrors production
# This file should be committed to version control

# Include base configuration
# Source base.env when loading this environment

# Environment Identification
ENVIRONMENT_NAME="staging"
ENVIRONMENT_TYPE="staging"
ENVIRONMENT_COLOR="#FFFF00"

# API Configuration
API_BASE_URL="https://api-staging.smilepile.app/api"
API_TIMEOUT="30"
API_RETRY_COUNT="3"
API_USE_MOCK="false"

# Database Configuration
DATABASE_HOST="staging-db.smilepile.internal"
DATABASE_PORT="5432"
DATABASE_NAME="smilepile_staging"
DATABASE_POOL_SIZE="20"
DATABASE_SSL_ENABLED="true"

# Build Configuration
BUILD_TYPE="release"
ANDROID_BUILD_VARIANT="stagingRelease"
IOS_BUILD_CONFIGURATION="Release-Staging"
OPTIMIZE_FOR_PRODUCTION="true"

# Debug Configuration
DEBUG_MODE="false"
ENABLE_DEBUG_MENU="false"
ENABLE_PERFORMANCE_MONITORING="true"
ENABLE_NETWORK_LOGGING="false"
LOG_LEVEL="WARN"

# Testing Configuration
RUN_UNIT_TESTS="true"
RUN_INTEGRATION_TESTS="true"
RUN_UI_TESTS="false"
RUN_SMOKE_TESTS="true"
RUN_REGRESSION_TESTS="true"
RUN_LOAD_TESTS="true"
MIN_TEST_COVERAGE="80"

# Security Configuration
ENABLE_CERTIFICATE_PINNING="true"
ENABLE_ROOT_DETECTION="true"
ENABLE_TAMPER_DETECTION="true"
ALLOW_HTTP_TRAFFIC="false"
SSL_PINNING_HOSTS="api-staging.smilepile.app,cdn-staging.smilepile.app"
ENFORCE_SECURE_CONNECTIONS="true"

# Performance Configuration
ENABLE_CACHING="true"
CACHE_TTL_SECONDS="7200"
ENABLE_COMPRESSION="true"
ENABLE_CDN="true"
CDN_BASE_URL="https://cdn-staging.smilepile.app"

# Monitoring Configuration
MONITORING_ENABLED="true"
APM_ENABLED="true"
APM_SAMPLE_RATE="0.1"
ERROR_TRACKING_ENABLED="true"
ERROR_TRACKING_ENVIRONMENT="staging"
ERROR_SAMPLE_RATE="0.5"

# Storage Configuration
STORAGE_BASE_URL="https://storage-staging.smilepile.app"
BACKUP_ENABLED="true"
BACKUP_RETENTION_DAYS="7"

# Notification Configuration
PUSH_NOTIFICATION_SERVER="https://push-staging.smilepile.app"
ENABLE_PUSH_NOTIFICATIONS="true"
NOTIFICATION_TEST_MODE="false"
EMAIL_SERVICE_URL="https://email-staging.smilepile.app"

# Staging Signing (Android)
ANDROID_KEYSTORE_PATH="/secure/keystores/staging.keystore"
ANDROID_KEY_ALIAS="staging-key"
# Passwords should be in secrets file

# Staging Signing (iOS)
IOS_CODE_SIGN_IDENTITY="iPhone Distribution: SmilePile Staging"
IOS_PROVISIONING_PROFILE="SmilePile Staging"
IOS_EXPORT_METHOD="ad-hoc"

# Feature Flags (Staging)
FEATURE_A_B_TESTING="true"
FEATURE_CANARY_RELEASES="true"
FEATURE_REMOTE_CONFIG="true"
FEATURE_GRADUAL_ROLLOUT="true"
FEATURE_BLUE_GREEN_DEPLOY="true"

# Analytics Configuration
ANALYTICS_ENABLED="true"
ANALYTICS_DEBUG_MODE="false"
ANALYTICS_BATCH_SIZE="50"
ANALYTICS_FLUSH_INTERVAL="60"
ANALYTICS_ENDPOINT="https://analytics-staging.smilepile.app"

# Load Testing Configuration
LOAD_TEST_ENABLED="true"
MAX_CONCURRENT_USERS="500"
TARGET_RPS="100"
LOAD_TEST_DURATION="300"

# Database Migration
RUN_MIGRATIONS="true"
MIGRATION_TIMEOUT="300"
ROLLBACK_ON_FAILURE="true"

# Deployment Configuration
DEPLOY_STRATEGY="blue-green"
HEALTH_CHECK_ENABLED="true"
HEALTH_CHECK_PATH="/health"
HEALTH_CHECK_INTERVAL="30"
WARMUP_REQUESTS="50"
CANARY_PERCENTAGE="10"

# Alerting Configuration
ALERT_ENABLED="true"
ALERT_THRESHOLD_ERROR_RATE="0.01"
ALERT_THRESHOLD_RESPONSE_TIME="1000"
ALERT_THRESHOLD_CPU="80"
ALERT_THRESHOLD_MEMORY="80"
ALERT_CHANNELS="slack,pagerduty,email"

# Backup and Recovery
BACKUP_BEFORE_DEPLOY="true"
AUTOMATIC_ROLLBACK="true"
ROLLBACK_TIMEOUT="300"
SNAPSHOT_ENABLED="true"

# Resource Limits
MAX_CONCURRENT_USERS="1000"
RATE_LIMIT_ENABLED="true"
RATE_LIMIT_REQUESTS_PER_MINUTE="120"
MAX_REQUEST_SIZE_MB="10"
MAX_UPLOAD_SIZE_MB="50"

# Service Dependencies
REDIS_URL="redis://staging-redis.smilepile.internal:6379"
ELASTICSEARCH_URL="https://staging-es.smilepile.internal:9200"
MESSAGE_QUEUE_URL="amqp://staging-mq.smilepile.internal:5672"

# Third-party Services (Staging)
FIREBASE_PROJECT_ID="smilepile-staging"
SENTRY_ENVIRONMENT="staging"
MIXPANEL_ENVIRONMENT="staging"
STRIPE_ENVIRONMENT="test"